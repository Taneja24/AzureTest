{
	"name": "dataflow1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "InputExcell",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "Aggregate1"
				},
				{
					"name": "Aggregate2"
				}
			],
			"script": "source(output(\n\t\t{Account Number} as string,\n\t\t{Agent ID} as string,\n\t\t{Air Booking Code} as string,\n\t\t{Air Booking Description} as string,\n\t\t{Airline Alliance} as string,\n\t\t{Arrival Day of Week} as string,\n\t\t{Back Office Tran ID} as string,\n\t\t{Booking Date} as string,\n\t\t{Booking IATA Number} as string,\n\t\t{Booking Method Code} as string,\n\t\t{Booking Method Description} as string,\n\t\t{Branch ID} as string,\n\t\t{CO2e kg} as string,\n\t\t{Client Defined 01} as string,\n\t\t{Client Defined 02} as string,\n\t\t{Client Defined 03} as string,\n\t\t{Client Defined 04} as string,\n\t\t{Client Defined 05} as string,\n\t\t{Client Defined 06} as string,\n\t\t{Client Defined 07} as string,\n\t\t{Client Defined 08} as string,\n\t\t{Client Defined 09} as string,\n\t\t{Client Defined 10} as string,\n\t\t{Client Defined 11} as string,\n\t\t{Client Defined 12} as string,\n\t\t{Client Defined 13} as string,\n\t\t{Client Defined 14} as string,\n\t\t{Client Defined 15} as string,\n\t\t{Client Defined 16} as string,\n\t\t{Client Defined 17} as string,\n\t\t{Client Defined 18} as string,\n\t\t{Client Defined 19} as string,\n\t\t{Client Defined 20} as string,\n\t\t{Client Master Code} as string,\n\t\t{Client Master Code Name} as string,\n\t\t{Client Name} as string,\n\t\t{Connection Indicator} as string,\n\t\t{Cost Difference} as string,\n\t\t{Coupon Airport Pair} as string,\n\t\t{Coupon Count} as string,\n\t\t{Coupon Level Arrival Date} as string,\n\t\t{Coupon Level Arrival Time} as string,\n\t\t{Coupon Level Departure Date} as string,\n\t\t{Coupon Level Departure Time} as string,\n\t\t{Coupon Level Trip Days} as string,\n\t\t{Coupon Miles} as string,\n\t\t{Coupon Number} as string,\n\t\t{Coupon Seat Class} as string,\n\t\t{Coupon Service Class - Converted Code} as string,\n\t\t{Coupon Service Class - Converted Description} as string,\n\t\t{Credit Card Code} as string,\n\t\t{Credit Card Number} as string,\n\t\t{Days in Country Trip Count} as string,\n\t\t{Departure Day of Week} as string,\n\t\t{Destination Airport Code} as string,\n\t\t{Destination Airport Name} as string,\n\t\t{Destination City Name} as string,\n\t\t{Destination Country Code} as string,\n\t\t{Destination Country Name} as string,\n\t\t{Destination Region Name} as string,\n\t\t{Destination State-Province Code} as string,\n\t\t{E-Ticket} as string,\n\t\t{Economy Comparison Fare} as string,\n\t\t{Exchange Indicator} as string,\n\t\t{Fare Basis Code} as string,\n\t\t{Fare by Coupon} as string,\n\t\t{Flight Duration} as string,\n\t\t{Flight Duration in Minutes} as string,\n\t\t{Flight Number} as string,\n\t\t{Flown Airline Code} as string,\n\t\t{Flown Airline Name} as string,\n\t\t{Form of Payment Code} as string,\n\t\t{Form of Payment Name} as string,\n\t\tGDS as string,\n\t\t{Hierarchy 1} as string,\n\t\t{Hierarchy 2} as string,\n\t\t{Hierarchy 3} as string,\n\t\t{Hierarchy 4} as string,\n\t\t{Hierarchy 5} as string,\n\t\t{Hierarchy 6} as string,\n\t\t{Hierarchy 7} as string,\n\t\t{Hierarchy 8} as string,\n\t\t{Invoice Number} as string,\n\t\t{Issue Date} as string,\n\t\t{Issuing Country Name} as string,\n\t\tKilometers as string,\n\t\t{Next Departure Date-Time} as string,\n\t\t{O&D Trip Type Description} as string,\n\t\t{Operating Airline Code} as string,\n\t\t{Operating Airline Name} as string,\n\t\t{Organization ID} as string,\n\t\t{Origin Airport Code} as string,\n\t\t{Origin Airport Name} as string,\n\t\t{Origin City Name} as string,\n\t\t{Origin Country Code} as string,\n\t\t{Origin Country Name} as string,\n\t\t{Origin Region Name} as string,\n\t\t{Origin State-Province Code} as string,\n\t\t{Original Paid Fare} as string,\n\t\tPNR as string,\n\t\t{Point of Sale Fee} as string,\n\t\t{Point of Sale Trip Type Description} as string,\n\t\t{RC Missed Global Code} as string,\n\t\t{RC Missed Global Description} as string,\n\t\t{RC Missed Local Code} as string,\n\t\t{RC Missed Local Description} as string,\n\t\t{RC Realized Global Code} as string,\n\t\t{RC Realized Global Description} as string,\n\t\t{RC Realized Local Code} as string,\n\t\t{RC Realized Local Description} as string,\n\t\t{Service Class Code} as string,\n\t\t{Service Class Description} as string,\n\t\t{Ticket Class Code} as string,\n\t\t{Ticket Class Description} as string,\n\t\t{Ticket Departure Date} as string,\n\t\t{Ticket Designator} as string,\n\t\t{Ticket Number} as string,\n\t\t{Ticket Paid Fare} as string,\n\t\t{Ticket Return Date} as string,\n\t\t{Ticket Routing} as string,\n\t\t{Ticket Status Code} as string,\n\t\t{Ticket Status Description} as string,\n\t\t{Ticketing IATA Number} as string,\n\t\t{Tickets Used} as string,\n\t\t{Tour Code} as string,\n\t\t{Transaction Type} as string,\n\t\t{Travel Purpose} as string,\n\t\t{Travel Type Code} as string,\n\t\t{Travel Type Description} as string,\n\t\t{Traveler Name} as string,\n\t\t{Validating Airline Code} as string,\n\t\t{Validating Airline Name} as string,\n\t\t{Validating Airline Number} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> source1\nsource1 aggregate(groupBy({Air Booking Code}),\n\t{Sum Coupon Miles} = {Coupon Miles}) ~> Aggregate1\nsource1 aggregate(groupBy({Ticket Routing}),\n\t{Sum Original Paid Fare} = {Original Paid Fare}) ~> Aggregate2"
		}
	}
}